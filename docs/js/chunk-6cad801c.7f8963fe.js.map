{"version":3,"sources":["webpack:///./src/contacthelp/useApproveCallback.js","webpack:///./src/views/earn/rewardMine/dialog/mlambPledge/mlambPledge.vue?1cad","webpack:///./src/views/earn/rewardMine/dialog/mlambPledge/index.js","webpack:///./src/views/earn/rewardMine/dialog/mlambPledge","webpack:///./src/views/earn/rewardMine/dialog/mlambPledge/mlambPledge.vue?5dcb","webpack:///./src/views/earn/rewardMine/dialog/mlambPledge/mlambPledge.vue?c362"],"names":["useApproveCallback","account","library","amountToApprove","spender","token","TokenAmount","undefined","tokenContract","useTokenContract","address","useExact","estimateGas","approve","MaxUint256","catch","raw","toString","estimatedGas","Promise","resolve","reject","gasLimit","calculateGasMargin","then","response","summary","currency","symbol","approval","tokenAddress","hash","error","render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","model","value","callback","$$v","openPledgeDialog","expression","_v","_s","$t","mLAMBBalance","directives","name","rawName","modifiers","domProps","on","checkApprove","$event","target","composing","pledgeAmount","_n","handleInput","$forceUpdate","percentage","nativeOn","approveTx","_e","needApprove","sendLoading","depositMLAMB","staticRenderFns","BigNumber","require","config","DECIMAL_PLACES","ROUNDING_MODE","ROUND_DOWN","components","Buttons","data","previousData","tokenObj","approveLoading","computed","mapState","methods","checkData","ethersprovider","ethAddress","chainId","ethChainID","decimals","tokenData","Token","amount","Web3","utils","toWei","useSushiBarEnter","result","event","$emit","okinfo","failinfo","open","getMlambBalance","tokens","filter","item","mLAMBItem","contractAddress","abi","mLAMBAbi","contract","web3","eth","Contract","balanceOf","call","res","div","decimalPlaces","toNumber","isNaN","debounce","rewardTokenAddress","dataAddress","useNeedApproveInput","wait","val","balance","percent","multipliedBy","e","stringValue","regex","match","bigBalance","$Notice","warning","title","desc","parseFloat","isGreaterThan","watch","component"],"mappings":"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","file":"js/chunk-6cad801c.7f8963fe.js","sourcesContent":["import { MaxUint256 } from \"@ethersproject/constants\";\nimport {\n  TokenAmount,\n} from \"@webfans/uniswapsdk\";\nimport { calculateGasMargin } from \"./utils\";\nimport { useTokenContract } from \"./useContract\";\n\nexport async function useApproveCallback(\n  account,\n  library,\n  amountToApprove,\n  spender\n) {\n  const token =\n    amountToApprove instanceof TokenAmount ? amountToApprove.token : undefined;\n  const tokenContract = useTokenContract(library, account, token.address);\n  if (!token) {\n    console.error(\"no token\");\n    return;\n  }\n\n  if (!tokenContract) {\n    console.error(\"tokenContract is null\");\n    return;\n  }\n\n  if (!amountToApprove) {\n    console.error(\"missing amount to approve\");\n    return;\n  }\n\n  if (!spender) {\n    console.error(\"no spender\");\n    return;\n  }\n\n  let useExact = false;\n  const estimatedGas = await tokenContract.estimateGas\n    .approve(spender, MaxUint256)\n    .catch(() => {\n      // general fallback for tokens who restrict approval amounts\n      useExact = true;\n      return tokenContract.estimateGas.approve(\n        spender,\n        amountToApprove.raw.toString()\n      );\n    });\n\n  return new Promise((resolve, reject) => {\n    tokenContract\n      .approve(spender, useExact ? amountToApprove.raw.toString() : MaxUint256, {\n        gasLimit: calculateGasMargin(estimatedGas)\n      })\n      .then(response => {\n        resolve({\n          summary: \"Approve \" + amountToApprove.currency.symbol,\n          approval: { tokenAddress: token.address, spender: spender },\n          hash: response.hash,\n          response: response\n        });\n      })\n      .catch(error => {\n        console.debug(\"Failed to approve token\", error);\n        reject(error);\n      });\n\n  });\n\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"pledge-dialog\"},[_c('Modal',{attrs:{\"class-name\":\"pledge-modal\",\"transfer\":false,\"footer-hide\":true,\"closable\":true},model:{value:(_vm.openPledgeDialog),callback:function ($$v) {_vm.openPledgeDialog=$$v},expression:\"openPledgeDialog\"}},[_c('div',{staticClass:\"pledge-content\"},[_c('p',{staticClass:\"title text-center\"},[_vm._v(\" 存入 mLAMB \")]),_c('div',{staticClass:\"pledge-wrapper\"},[_c('div',{staticClass:\"title-content\"},[_c('span',{staticClass:\"card-title\"},[_vm._v(_vm._s(_vm.$t('earn.dialog.stakeDialog.amount')))]),_c('div',{staticClass:\"balance-item\"},[_c('span',{staticClass:\"mr-2 text-secondary\"},[_vm._v(\"mLAMB \"+_vm._s(_vm.$t('earn.dialog.stakeDialog.balance')))]),_c('span',[_vm._v(_vm._s(_vm.mLAMBBalance))])])]),_c('div',{staticClass:\"pledge-wrapper flex\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.pledgeAmount),expression:\"pledgeAmount\",modifiers:{\"number\":true}}],staticClass:\"amount-input\",attrs:{\"type\":\"number\"},domProps:{\"value\":(_vm.pledgeAmount)},on:{\"keyup\":_vm.checkApprove,\"input\":[function($event){if($event.target.composing){ return; }_vm.pledgeAmount=_vm._n($event.target.value)},_vm.handleInput],\"blur\":function($event){return _vm.$forceUpdate()}}})]),_c('div',{staticClass:\"percentage\"},[_c('div',{on:{\"click\":function($event){return _vm.percentage(0.25)}}},[_vm._v(\" 25% \")]),_c('div',{on:{\"click\":function($event){return _vm.percentage(0.5)}}},[_vm._v(\" 50% \")]),_c('div',{on:{\"click\":function($event){return _vm.percentage(0.75)}}},[_vm._v(\" 75% \")]),_c('div',{on:{\"click\":function($event){return _vm.percentage(1)}}},[_vm._v(\" \"+_vm._s(_vm.$t('earn.dialog.stakeDialog.max'))+\" \")])])]),_c('div',{staticClass:\"price-wrapper\"},[_c('div',{staticClass:\"price-item\"},[_c('span',[_vm._v(_vm._s(_vm.$t('earn.dialog.stakeDialog.willStake')))]),_c('p',[_vm._v(_vm._s(_vm.pledgeAmount || 0)+\" mLAMB\")])])]),_c('div',{staticClass:\"btn-wrapper\"},[(_vm.needApprove)?[(_vm.approveLoading)?_c('Buttons',[_vm._v(\" \"+_vm._s(_vm.$t('earn.dialog.loading'))+\" \")]):_c('Buttons',{nativeOn:{\"click\":function($event){return _vm.approveTx($event)}}},[_vm._v(\" 授权 \")])]:_vm._e(),(!_vm.needApprove)?[(_vm.sendLoading === false)?_c('Buttons',{nativeOn:{\"click\":function($event){return _vm.depositMLAMB($event)}}},[_vm._v(\" \"+_vm._s(_vm.$t('earn.dialog.stakeDialog.confirm'))+\" \")]):_c('Buttons',[_vm._v(\" \"+_vm._s(_vm.$t('earn.dialog.loading'))+\" \")])]:_vm._e()],2)])])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { mapState } from 'vuex';\nconst BigNumber = require('bignumber.js');\nBigNumber.config({ DECIMAL_PLACES: 6, ROUNDING_MODE: BigNumber.ROUND_DOWN });\nimport { debounce } from 'debounce';\nimport { TokenAmount, Token } from '@webfans/uniswapsdk';\nimport { useNeedApproveInput } from '@/contacthelp/useNeedApprove.js';\nimport { useApproveCallback } from '@/contacthelp/useApproveCallback.js';\nimport token from '@/constants/token.json';\nimport mLAMBAbi from '@/constants/abis/erc20mLAMB.json';\nimport Web3 from 'web3';\nimport { useSushiBarEnter } from '../../../utils/helpUtils/mineUtilFunc.js';\nimport event from '@/common/js/event';\nexport default {\n    components: {\n        Buttons: () =>\n            import ('@/components/basic/buttons'),\n    },\n    data() {\n        return {\n            openPledgeDialog: false,\n            pledgeAmount: '',\n            data: {},\n            previousData: '',\n            sendLoading: false,\n            mLAMBBalance: 0,\n            needApprove: false,\n            tokenObj: {},\n            approveLoading: false\n        };\n    },\n    computed: {\n        ...mapState(['ethersprovider', 'ethAddress', 'ethChainID', 'web3']),\n    },\n    methods: {\n        // 存入mLAMB\n        async depositMLAMB() {\n            if (!this.checkData()) {\n                return false;\n            }\n            this.sendLoading = true;\n            try {\n                const library = this.ethersprovider;\n                const account = this.ethAddress;\n\n                const chainId = this.ethChainID;\n                const address = this.data && this.data.address;\n                const decimals = this.data && this.data.decimals;\n                const symbol = this.data && this.data.symbol;\n\n                const tokenData = new Token(chainId, address, decimals, symbol);\n\n                const amount = Web3.utils.toWei(this.pledgeAmount.toString(), 'ether');\n                const result = await useSushiBarEnter(library, account, tokenData, amount);\n                if (result.hash) {\n                    event.$emit('sendSuccess');\n                    event.$emit('sendtx', [\n                        result,\n                        {\n                            okinfo: `存入 ${this.pledgeAmount} mLAMB ${this.$t('notice.n42')}`,\n                            failinfo: `存入 ${this.pledgeAmount} mLAMB ${this.$t('notice.n43')}`,\n                        },\n                    ]);\n                }\n            } catch (error) {\n                console.log(error);\n            } finally {\n                this.openPledgeDialog = false;\n                this.sendLoading = false;\n            }\n        },\n\n        open(data) {\n            console.log({ data });\n            this.data = {};\n            this.data = data;\n            this.pledgeAmount = '';\n            this.getMlambBalance();\n            this.openPledgeDialog = true;\n        },\n\n        // 获取mlamb余额\n        async getMlambBalance() {\n            const [mLAMBItem] = token.tokens.filter(item => item.name === 'mLAMB' && item.chainId === this.ethChainID);\n            const contractAddress = mLAMBItem.address;\n            const abi = mLAMBAbi;\n            const contract = new this.web3.eth.Contract(abi, contractAddress);\n            try {\n                const res = await contract.methods\n                    .balanceOf(this.ethAddress)\n                    .call();\n                let result = new BigNumber(res).div(\"1e18\").decimalPlaces(6).toNumber();\n                if (isNaN(result)) {\n                    result = 0;\n                }\n                this.mLAMBBalance = result;\n            } catch (error) {\n                console.log(error);\n            }\n        },\n\n        // 检查授权\n        checkApprove: debounce(async function() {\n            try {\n                const chainId = this.ethChainID;\n                const address = this.data && this.data.data.rewardTokenAddress;\n                const decimals = this.data && this.data.decimals;\n                const symbol = this.data && this.data.symbol;\n                const tokenData = new Token(chainId, address, decimals, symbol);\n\n                // 需要将数据转为字符串格式\n                const amount = this.pledgeAmount.toString();\n\n                // 批准mlamb的授权\n                const amountToApprove = new TokenAmount(tokenData, Web3.utils.toWei(amount, 'ether'));\n\n                // xmlamb地址\n                this.tokenObj.dataAddress = this.data && this.data.address;\n                this.tokenObj.amountToApprove = amountToApprove;\n\n                // 检查授权\n                this.needApprove = await useNeedApproveInput(\n                    this.ethAddress,\n                    this.ethersprovider,\n                    amountToApprove,\n                    this.tokenObj.dataAddress\n                );\n                console.log(this.needApprove);\n            } catch (error) {\n                console.log(error);\n            }\n        }, 800),\n\n        // 授权操作\n        async approveTx() {\n            if (!this.checkData()) {\n                return false;\n            }\n            try {\n                this.approveLoading = true;\n                const result = await useApproveCallback(\n                    this.ethAddress,\n                    this.ethersprovider,\n                    this.tokenObj.amountToApprove,\n                    this.tokenObj.dataAddress\n                );\n                if (result) {\n                    const wait = await result.response.wait([1]);\n                    if (wait) {\n                        this.needApprove = false;\n                        this.approveLoading = false;\n                    }\n                }\n            } catch (error) {\n                this.approveLoading = false;\n                console.log(error);\n            }\n        },\n\n        percentage(val) {\n            const balance = new BigNumber(this.mLAMBBalance);\n            const percent = new BigNumber(val);\n            this.pledgeAmount = balance.multipliedBy(percent).decimalPlaces(6).toNumber();\n        },\n\n\n        // 限制Input输入小数点的长度\n        handleInput(e) {\n            const stringValue = e.target.value.toString();\n            const regex = /^\\d*(\\.\\d{1,6})?$/;\n            if (!stringValue.match(regex) && this.pledgeAmount !== '') {\n                this.pledgeAmount = this.previousData;\n            }\n            this.previousData = this.pledgeAmount;\n        },\n\n        // 检验数据是否合法\n        checkData() {\n            const balance = this.mLAMBBalance;\n            const bigBalance = new BigNumber(balance);\n            const amount = new BigNumber(this.pledgeAmount);\n            if (this.pledgeAmount === '') {\n                this.$Notice.warning({\n                    title: this.$t('notice.n'),\n                    desc: this.$t('notice.n30'),\n                });\n                return false;\n            }\n            if (parseFloat(this.pledgeAmount) <= 0) {\n                this.$Notice.warning({\n                    title: this.$t('notice.n'),\n                    desc: this.$t('notice.n31'),\n                });\n                return false;\n            }\n            // console.log(amount.toNumber(),bigBalance.toNumber(),amount.isGreaterThan(bigBalance));\n            if (amount.isGreaterThan(bigBalance)) {\n                this.$Notice.warning({\n                    title: this.$t('notice.n'),\n                    desc: this.$t('notice.n29'),\n                });\n                return false;\n            }\n\n            return true;\n        },\n\n    },\n    watch: {\n        pledgeAmount() {\n            this.checkApprove();\n        }\n    }\n};","import mod from \"-!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../../node_modules/babel-loader/lib/index.js!../../../../../../node_modules/eslint-loader/index.js??ref--13-0!./index.js?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../../node_modules/babel-loader/lib/index.js!../../../../../../node_modules/eslint-loader/index.js??ref--13-0!./index.js?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./mlambPledge.vue?vue&type=template&id=8c8955a0&scoped=true&\"\nimport script from \"./index.js?vue&type=script&lang=js&\"\nexport * from \"./index.js?vue&type=script&lang=js&\"\nimport style0 from \"./mlambPledge.vue?vue&type=style&index=0&id=8c8955a0&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"8c8955a0\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./mlambPledge.vue?vue&type=style&index=0&id=8c8955a0&lang=less&scoped=true&\""],"sourceRoot":""}