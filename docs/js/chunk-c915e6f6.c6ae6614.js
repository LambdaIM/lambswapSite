(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c915e6f6"],{"1d92":function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a("1da1"),s=(a("96cf"),a("d3b7"),a("25f0"),a("9d56")),i=a("6df3"),r=a("adae"),o=a("a004");function c(e,t,a,n){return d.apply(this,arguments)}function d(){return d=Object(n["a"])(regeneratorRuntime.mark((function e(t,a,n,c){var d,l,p,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(d=n instanceof i["TokenAmount"]?n.token:void 0,l=Object(o["i"])(a,t,d.address),d){e.next=5;break}return e.abrupt("return");case 5:if(l){e.next=8;break}return e.abrupt("return");case 8:if(n){e.next=11;break}return e.abrupt("return");case 11:if(c){e.next=14;break}return e.abrupt("return");case 14:return p=!1,e.next=17,l.estimateGas.approve(c,s["a"]).catch((function(){return p=!0,l.estimateGas.approve(c,n.raw.toString())}));case 17:return u=e.sent,e.abrupt("return",new Promise((function(e,t){l.approve(c,p?n.raw.toString():s["a"],{gasLimit:Object(r["b"])(u)}).then((function(t){e({summary:"Approve "+n.currency.symbol,approval:{tokenAddress:d.address,spender:c},hash:t.hash,response:t})})).catch((function(e){t(e)}))})));case 19:case"end":return e.stop()}}),e)}))),d.apply(this,arguments)}},4870:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"pledge-dialog"},[n("Modal",{attrs:{"class-name":"pledge-modal",transfer:!1,"footer-hide":!0,closable:!0},model:{value:e.openPledgeDialog,callback:function(t){e.openPledgeDialog=t},expression:"openPledgeDialog"}},[e.isShowPledge?n("div",{staticClass:"pledge-content"},[n("p",{staticClass:"title text-center"},[e._v(" "+e._s(e.$t("earn.card.stake"))+" "+e._s(e.data.name)+" ")]),n("div",{staticClass:"pledge-wrapper"},[n("div",{staticClass:"title-content"},[n("span",{staticClass:"card-title"},[e._v(e._s(e.$t("earn.dialog.stakeDialog.amount")))]),n("div",{staticClass:"balance-item"},[n("span",{staticClass:"mr-2 text-secondary"},[e._v(e._s(e.data.name)+" "+e._s(e.$t("earn.dialog.stakeDialog.balance")))]),n("span",[e._v(e._s(e.data.data&&e.data.data.LPTokenbalance))])])]),n("div",{staticClass:"pledge-wrapper flex"},[n("input",{directives:[{name:"model",rawName:"v-model.number",value:e.pledgeAmount,expression:"pledgeAmount",modifiers:{number:!0}}],staticClass:"amount-input",attrs:{type:"number"},domProps:{value:e.pledgeAmount},on:{keyup:e.checkApprove,input:[function(t){t.target.composing||(e.pledgeAmount=e._n(t.target.value))},e.handleInput],blur:function(t){return e.$forceUpdate()}}})]),n("div",{staticClass:"percentage"},[n("div",{on:{click:function(t){return e.percentage(.25)}}},[e._v(" 25% ")]),n("div",{on:{click:function(t){return e.percentage(.5)}}},[e._v(" 50% ")]),n("div",{on:{click:function(t){return e.percentage(.75)}}},[e._v(" 75% ")]),n("div",{on:{click:function(t){return e.percentage(1)}}},[e._v(" "+e._s(e.$t("earn.dialog.stakeDialog.max"))+" ")])])]),n("div",{staticClass:"price-wrapper"},[n("div",{staticClass:"price-item"},[n("span",[e._v(e._s(e.$t("earn.dialog.stakeDialog.totalStakePool")))]),n("p",[e._v(e._s(e.data.data&&e.data.data.totalSupply)+" "+e._s(e.data.name))])]),n("div",{staticClass:"price-item"},[n("span",[e._v(e._s(e.$t("earn.dialog.stakeDialog.willStake")))]),n("p",[e._v(e._s(e.pledgeAmount||0)+" "+e._s(e.data.name))])])]),n("div",{staticClass:"btn-wrapper"},[e.needApprove?[e.approveLoading?n("Buttons",{staticClass:"dialogBtn"},[e._v(" "+e._s(e.$t("earn.dialog.loading"))+" ")]):n("Buttons",{staticClass:"dialogBtn",nativeOn:{click:function(t){return e.approveTx(t)}}},[e._v(" "+e._s(e.$t("earn.dialog.stakeDialog.approve"))+" ")])]:e._e(),e.needApprove?e._e():[n("Buttons",{nativeOn:{click:function(t){return e.showConfirnDialog(t)}}},[e._v(" "+e._s(e.$t("earn.dialog.stakeDialog.next"))+" ")])]],2)]):n("div",[n("div",{staticClass:"confirmPledge-content"},[n("div",{staticClass:"arrow-wrapper",on:{click:e.showPledgeDialog}},[n("img",{attrs:{src:a("f3a0"),alt:"arrow-left"}})]),n("p",{staticClass:"title text-center"},[e._v(" "+e._s(e.$t("earn.dialog.stakeDialog.confirm"))+" ")]),n("div",{staticClass:"confirm-content"},[n("div",{staticClass:"images-wrapper items-center"},[n("img",{attrs:{src:e.data.img1,alt:"comp"}}),n("img",{staticClass:"img2",attrs:{src:e.data.img2,alt:"comp"}})]),n("h2",[e._v(e._s(e.pledgeAmount))]),n("p",[e._v(e._s(e.data.name))]),n("span",[e._v(e._s(e.$t("earn.dialog.stakeDialog.willMine")))])]),n("div",{staticClass:"price-wrapper"},[n("div",[n("span",[e._v(e._s(e.$t("earn.dialog.stakeDialog.asset")))]),n("div",[n("div",{staticClass:"images-wrapper"},[n("img",{attrs:{src:e.data.img1,width:"14",alt:"comp"}}),n("img",{staticClass:"img2",attrs:{src:e.data.img2,width:"14",alt:"comp"}})]),n("p",[e._v(e._s(e.data.name))])])]),n("div",[n("span",[e._v(e._s(e.$t("earn.dialog.stakeDialog.sharePool")))]),n("p",[e._v(e._s(e.increaseRate))])]),n("div",[n("span",[e._v("Fee")]),n("p",[e._v("$"+e._s(e.fee))])])]),!1===e.sendLoading?n("Buttons",{nativeOn:{click:function(t){return e.confirmSendTx(t)}}},[e._v(" "+e._s(e.$t("earn.dialog.stakeDialog.confirm"))+" ")]):n("Buttons",[e._v(" "+e._s(e.$t("earn.dialog.loading"))+" ")])],1)])])],1)},s=[],i=a("1da1"),r=a("5530"),o=(a("96cf"),a("d3b7"),a("3ca3"),a("ddb0"),a("25f0"),a("466d"),a("ac1f"),a("b0c0"),a("99af"),a("2f62")),c=a("6612"),d=a.n(c),l=a("b012"),p=a("6df3"),u=a("fb7b"),g=a("1d92"),h=a("dccc"),v=a("5bed"),m=a("0ee2"),f=a("901e");f.config({DECIMAL_PLACES:6,ROUNDING_MODE:f.ROUND_DOWN});var b={components:{Buttons:function(){return a.e("chunk-2d225272").then(a.bind(null,"e2d3"))}},data:function(){return{openPledgeDialog:!1,isShowPledge:!0,pledgeAmount:"",data:{},needApprove:!1,approveLoading:!1,previousData:"",tokenObj:{},amountApproveObj:{},sendLoading:!1,fee:""}},computed:Object(r["a"])(Object(r["a"])({},Object(o["b"])(["ethersprovider","ethAddress","ethChainID","web3","chainTokenPrice"])),{},{increaseRate:function(){var e=new f(this.pledgeAmount),t=new f(this.data&&this.data.data&&this.data.data.totalSupply),a=e.div(t.plus(e)).decimalPlaces(6).toNumber();return d()(a).format("0.[0000]%")}}),methods:{showConfirnDialog:function(){if(!this.checkData())return!1;this.getFee(),this.isShowPledge=!1},showPledgeDialog:function(){this.isShowPledge=!0},open:function(e){this.data={},this.data=e,this.pledgeAmount="",this.isShowPledge=!0,this.openPledgeDialog=!0},toExchange:function(){this.$router.push("/exchange")},percentage:function(e){var t=new f(this.data.data.LPTokenbalance),a=new f(e);this.pledgeAmount=t.multipliedBy(a).decimalPlaces(6).toNumber()},getFee:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,n,s,i,r,o,c,d,l,p;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,a=e.pledgeAmount.toString(),n=e.web3.utils.toWei(a,"ether"),s=e.data,i=Object(h["a"])(e.ethersprovider,e.ethAddress,s),t.next=7,i.estimateGas.stake(n);case 7:return r=t.sent,t.next=10,Object(m["a"])(e.ethersprovider);case 10:o=t.sent,c=new f(o),d=new f(r.toString()),l=new f(e.chainTokenPrice),p=d.times(l).times(c).div("1e18"),e.fee=p.decimalPlaces(6).toNumber(),t.next=22;break;case 19:t.prev=19,t.t0=t["catch"](0);case 22:case"end":return t.stop()}}),t,null,[[0,19]])})))()},handleInput:function(e){var t=e.target.value.toString(),a=/^\d*(\.\d{1,6})?$/;t.match(a)||""===this.pledgeAmount||(this.pledgeAmount=this.previousData),this.previousData=this.pledgeAmount},checkApprove:Object(l["debounce"])(Object(i["a"])(regeneratorRuntime.mark((function e(){var t,a,n,s,i,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t=this.ethChainID,a=this.data&&this.data.data&&this.data.data.LPTokenAddress,n=this.data&&this.data.decimals,s=this.data&&this.data.symbol,i=new p["Token"](t,a,n,s),r=this.pledgeAmount.toString(),o=new p["TokenAmount"](i,this.web3.utils.toWei(r,"ether")),this.tokenObj.dataAddress=this.data&&this.data.address,this.tokenObj.amountToApprove=o,e.next=12,Object(u["b"])(this.ethAddress,this.ethersprovider,o,this.tokenObj.dataAddress);case 12:this.needApprove=e.sent,e.next=18;break;case 15:e.prev=15,e.t0=e["catch"](0);case 18:case"end":return e.stop()}}),e,this,[[0,15]])}))),800),approveTx:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.checkData()){t.next=2;break}return t.abrupt("return",!1);case 2:return t.prev=2,e.approveLoading=!0,t.next=6,Object(g["a"])(e.ethAddress,e.ethersprovider,e.tokenObj.amountToApprove,e.tokenObj.dataAddress);case 6:if(a=t.sent,!a){t.next=12;break}return t.next=10,a.response.wait([1]);case 10:n=t.sent,n&&(e.needApprove=!1,e.approveLoading=!1);case 12:t.next=18;break;case 14:t.prev=14,t.t0=t["catch"](2),e.approveLoading=!1;case 18:case"end":return t.stop()}}),t,null,[[2,14]])})))()},checkData:function(){var e=this.data&&this.data.data.LPTokenbalance,t=new f(e),a=new f(this.pledgeAmount);return""===this.pledgeAmount?(this.$Notice.warning({title:this.$t("notice.n"),desc:this.$t("notice.n30")}),!1):parseFloat(this.pledgeAmount)<=0?(this.$Notice.warning({title:this.$t("notice.n"),desc:this.$t("notice.n31")}),!1):!a.isGreaterThan(t)||(this.$Notice.warning({title:this.$t("notice.n"),desc:this.$t("notice.n29")}),!1)},confirmSendTx:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,n,s,i,r,o,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.sendLoading=!0,a=e.pledgeAmount.toString(),n=e.web3.utils.toWei(a,"ether"),s=e.data,t.prev=4,i=Object(h["a"])(e.ethersprovider,e.ethAddress,s),t.next=8,i.estimateGas.stake(n);case 8:return r=t.sent,t.next=11,i.stake(n,{gasLimit:r});case 11:o=t.sent,c=e.data&&e.data.name,v["a"].$emit("sendSuccess"),v["a"].$emit("sendtx",[o,{okinfo:"".concat(e.$t("common.stake")," ").concat(e.pledgeAmount," ").concat(c," ").concat(e.$t("notice.n42")),failinfo:"".concat(e.$t("common.stake")," ").concat(e.pledgeAmount," ").concat(c," ").concat(e.$t("notice.n43"))}]),t.next=20;break;case 17:t.prev=17,t.t0=t["catch"](4);case 20:return t.prev=20,e.openPledgeDialog=!1,e.sendLoading=!1,t.finish(20);case 24:case"end":return t.stop()}}),t,null,[[4,17,20,24]])})))()}},watch:{pledgeAmount:function(){this.checkApprove()}}},k=b,w=(a("cc6b"),a("2877")),_=Object(w["a"])(k,n,s,!1,null,"2e8978de",null);t["default"]=_.exports},ad3e:function(e,t,a){},cc6b:function(e,t,a){"use strict";a("ad3e")},f3a0:function(e,t,a){e.exports=a.p+"img/arrow-left.e1aaf66f.svg"}}]);
//# sourceMappingURL=chunk-c915e6f6.c6ae6614.js.map