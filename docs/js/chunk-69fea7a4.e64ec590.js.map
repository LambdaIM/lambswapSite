{"version":3,"sources":["webpack:///./node_modules/core-js/internals/get-substitution.js","webpack:///./src/contacthelp/useApproveCallback.js","webpack:///./src/views/earn/rewardMine/dialog/mlambPledge/mlambPledge.vue?7eb6","webpack:///./src/views/earn/rewardMine/dialog/mlambPledge/index.js","webpack:///./src/views/earn/rewardMine/dialog/mlambPledge","webpack:///./src/views/earn/rewardMine/dialog/mlambPledge/mlambPledge.vue?5dcb","webpack:///./node_modules/core-js/modules/es.string.replace.js","webpack:///./src/views/earn/rewardMine/dialog/mlambPledge/mlambPledge.vue?5b7b"],"names":["toObject","floor","Math","replace","SUBSTITUTION_SYMBOLS","SUBSTITUTION_SYMBOLS_NO_NAMED","module","exports","matched","str","position","captures","namedCaptures","replacement","tailPos","length","m","symbols","undefined","call","match","ch","capture","charAt","slice","n","f","useApproveCallback","account","library","amountToApprove","spender","token","TokenAmount","tokenContract","useTokenContract","address","useExact","estimateGas","approve","MaxUint256","catch","raw","toString","estimatedGas","Promise","resolve","reject","gasLimit","calculateGasMargin","then","response","summary","currency","symbol","approval","tokenAddress","hash","error","render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","model","value","callback","$$v","openPledgeDialog","expression","_v","_s","$t","mLAMBBalance","directives","name","rawName","modifiers","domProps","on","checkApprove","$event","target","composing","pledgeAmount","_n","handleInput","$forceUpdate","percentage","nativeOn","approveTx","_e","needApprove","sendLoading","depositMLAMB","staticRenderFns","BigNumber","require","config","DECIMAL_PLACES","ROUNDING_MODE","ROUND_DOWN","components","Buttons","data","tokenObj","approveLoading","computed","mapState","methods","checkData","ethersprovider","ethAddress","chainId","ethChainID","decimals","tokenData","Token","amount","Web3","utils","toWei","useSushiBarEnter","result","event","$emit","okinfo","failinfo","open","getMlambBalance","tokens","filter","item","mLAMBItem","contractAddress","abi","mLAMBAbi","contract","web3","eth","Contract","balanceOf","res","div","decimalPlaces","toNumber","isNaN","debounce","rewardTokenAddress","dataAddress","useNeedApproveInput","wait","val","balance","percent","multipliedBy","e","stringValue","bigBalance","$Notice","warning","title","desc","parseFloat","isGreaterThan","watch","component","fixRegExpWellKnownSymbolLogic","anObject","toLength","toInteger","requireObjectCoercible","advanceStringIndex","getSubstitution","regExpExec","max","min","maybeToString","it","String","REPLACE","nativeReplace","maybeCallNative","reason","REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE","REPLACE_KEEPS_$0","UNSAFE_SUBSTITUTE","searchValue","replaceValue","O","replacer","regexp","indexOf","done","rx","S","functionalReplace","global","fullUnicode","unicode","lastIndex","results","push","matchStr","accumulatedResult","nextSourcePosition","i","index","j","groups","replacerArgs","concat","apply"],"mappings":"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","file":"js/chunk-69fea7a4.e64ec590.js","sourcesContent":["var toObject = require('../internals/to-object');\n\nvar floor = Math.floor;\nvar replace = ''.replace;\nvar SUBSTITUTION_SYMBOLS = /\\$([$&'`]|\\d{1,2}|<[^>]*>)/g;\nvar SUBSTITUTION_SYMBOLS_NO_NAMED = /\\$([$&'`]|\\d{1,2})/g;\n\n// https://tc39.es/ecma262/#sec-getsubstitution\nmodule.exports = function (matched, str, position, captures, namedCaptures, replacement) {\n  var tailPos = position + matched.length;\n  var m = captures.length;\n  var symbols = SUBSTITUTION_SYMBOLS_NO_NAMED;\n  if (namedCaptures !== undefined) {\n    namedCaptures = toObject(namedCaptures);\n    symbols = SUBSTITUTION_SYMBOLS;\n  }\n  return replace.call(replacement, symbols, function (match, ch) {\n    var capture;\n    switch (ch.charAt(0)) {\n      case '$': return '$';\n      case '&': return matched;\n      case '`': return str.slice(0, position);\n      case \"'\": return str.slice(tailPos);\n      case '<':\n        capture = namedCaptures[ch.slice(1, -1)];\n        break;\n      default: // \\d\\d?\n        var n = +ch;\n        if (n === 0) return match;\n        if (n > m) {\n          var f = floor(n / 10);\n          if (f === 0) return match;\n          if (f <= m) return captures[f - 1] === undefined ? ch.charAt(1) : captures[f - 1] + ch.charAt(1);\n          return match;\n        }\n        capture = captures[n - 1];\n    }\n    return capture === undefined ? '' : capture;\n  });\n};\n","import { MaxUint256 } from \"@ethersproject/constants\";\nimport {\n  TokenAmount,\n} from \"@webfans/uniswapsdk\";\nimport { calculateGasMargin } from \"./utils\";\nimport { useTokenContract } from \"./useContract\";\n\nexport async function useApproveCallback(\n  account,\n  library,\n  amountToApprove,\n  spender\n) {\n  const token =\n    amountToApprove instanceof TokenAmount ? amountToApprove.token : undefined;\n  const tokenContract = useTokenContract(library, account, token.address);\n  if (!token) {\n    console.error(\"no token\");\n    return;\n  }\n\n  if (!tokenContract) {\n    console.error(\"tokenContract is null\");\n    return;\n  }\n\n  if (!amountToApprove) {\n    console.error(\"missing amount to approve\");\n    return;\n  }\n\n  if (!spender) {\n    console.error(\"no spender\");\n    return;\n  }\n\n  let useExact = false;\n  const estimatedGas = await tokenContract.estimateGas\n    .approve(spender, MaxUint256)\n    .catch(() => {\n      // general fallback for tokens who restrict approval amounts\n      useExact = true;\n      return tokenContract.estimateGas.approve(\n        spender,\n        amountToApprove.raw.toString()\n      );\n    });\n\n  return new Promise((resolve, reject) => {\n    tokenContract\n      .approve(spender, useExact ? amountToApprove.raw.toString() : MaxUint256, {\n        gasLimit: calculateGasMargin(estimatedGas)\n      })\n      .then(response => {\n        resolve({\n          summary: \"Approve \" + amountToApprove.currency.symbol,\n          approval: { tokenAddress: token.address, spender: spender },\n          hash: response.hash,\n          response: response\n        });\n      })\n      .catch(error => {\n        console.debug(\"Failed to approve token\", error);\n        reject(error);\n      });\n\n  });\n\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"pledge-dialog\"},[_c('Modal',{attrs:{\"class-name\":\"pledge-modal\",\"transfer\":false,\"footer-hide\":true,\"closable\":true},model:{value:(_vm.openPledgeDialog),callback:function ($$v) {_vm.openPledgeDialog=$$v},expression:\"openPledgeDialog\"}},[_c('div',{staticClass:\"pledge-content\"},[_c('p',{staticClass:\"title text-center\"},[_vm._v(\" 存入 mLAMB \")]),_c('div',{staticClass:\"pledge-wrapper\"},[_c('div',{staticClass:\"title-content\"},[_c('span',{staticClass:\"card-title\"},[_vm._v(_vm._s(_vm.$t('earn.dialog.stakeDialog.amount')))]),_c('div',{staticClass:\"balance-item\"},[_c('span',{staticClass:\"mr-2 text-secondary\"},[_vm._v(\"mLAMB \"+_vm._s(_vm.$t('earn.dialog.stakeDialog.balance')))]),_c('span',[_vm._v(_vm._s(_vm.mLAMBBalance))])])]),_c('div',{staticClass:\"pledge-wrapper flex\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.pledgeAmount),expression:\"pledgeAmount\",modifiers:{\"number\":true}}],staticClass:\"amount-input\",attrs:{\"type\":\"number\",\"pattern\":\"[0-9]*.?[0-9]{0,6}\"},domProps:{\"value\":(_vm.pledgeAmount)},on:{\"keyup\":_vm.checkApprove,\"input\":[function($event){if($event.target.composing){ return; }_vm.pledgeAmount=_vm._n($event.target.value)},_vm.handleInput],\"blur\":function($event){return _vm.$forceUpdate()}}})]),_c('div',{staticClass:\"percentage\"},[_c('div',{on:{\"click\":function($event){return _vm.percentage(0.25)}}},[_vm._v(\" 25% \")]),_c('div',{on:{\"click\":function($event){return _vm.percentage(0.5)}}},[_vm._v(\" 50% \")]),_c('div',{on:{\"click\":function($event){return _vm.percentage(0.75)}}},[_vm._v(\" 75% \")]),_c('div',{on:{\"click\":function($event){return _vm.percentage(1)}}},[_vm._v(\" \"+_vm._s(_vm.$t('earn.dialog.stakeDialog.max'))+\" \")])])]),_c('div',{staticClass:\"price-wrapper\"},[_c('div',{staticClass:\"price-item\"},[_c('span',[_vm._v(_vm._s(_vm.$t('earn.dialog.stakeDialog.willStake')))]),_c('p',[_vm._v(_vm._s(_vm.pledgeAmount || 0)+\" mLAMB\")])])]),_c('div',{staticClass:\"btn-wrapper\"},[(_vm.needApprove)?[(_vm.approveLoading)?_c('Buttons',[_vm._v(\" \"+_vm._s(_vm.$t('earn.dialog.loading'))+\" \")]):_c('Buttons',{nativeOn:{\"click\":function($event){return _vm.approveTx($event)}}},[_vm._v(\" 授权 \")])]:_vm._e(),(!_vm.needApprove)?[(_vm.sendLoading === false)?_c('Buttons',{nativeOn:{\"click\":function($event){return _vm.depositMLAMB($event)}}},[_vm._v(\" \"+_vm._s(_vm.$t('earn.dialog.stakeDialog.confirm'))+\" \")]):_c('Buttons',[_vm._v(\" \"+_vm._s(_vm.$t('earn.dialog.loading'))+\" \")])]:_vm._e()],2)])])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { mapState } from 'vuex';\nconst BigNumber = require('bignumber.js');\nBigNumber.config({ DECIMAL_PLACES: 6, ROUNDING_MODE: BigNumber.ROUND_DOWN });\nimport { debounce } from 'debounce';\nimport { TokenAmount, Token } from '@webfans/uniswapsdk';\nimport { useNeedApproveInput } from '@/contacthelp/useNeedApprove.js';\nimport { useApproveCallback } from '@/contacthelp/useApproveCallback.js';\nimport token from '@/constants/token.json';\nimport mLAMBAbi from '@/constants/abis/erc20mLAMB.json';\nimport Web3 from 'web3';\nimport { useSushiBarEnter } from '../../../utils/helpUtils/mineUtilFunc.js';\nimport event from '@/common/js/event';\nexport default {\n    components: {\n        Buttons: () =>\n            import ('@/components/basic/buttons'),\n    },\n    data() {\n        return {\n            openPledgeDialog: false,\n            pledgeAmount: '',\n            data: {},\n            sendLoading: false,\n            mLAMBBalance: 0,\n            needApprove: false,\n            tokenObj: {},\n            approveLoading: false\n        };\n    },\n    computed: {\n        ...mapState(['ethersprovider', 'ethAddress', 'ethChainID', 'web3']),\n    },\n    methods: {\n        // 存入mLAMB\n        async depositMLAMB() {\n            if (!this.checkData()) {\n                return false;\n            }\n            this.sendLoading = true;\n            try {\n                const library = this.ethersprovider;\n                const account = this.ethAddress;\n\n                const chainId = this.ethChainID;\n                const address = this.data && this.data.address;\n                const decimals = this.data && this.data.decimals;\n                const symbol = this.data && this.data.symbol;\n\n                const tokenData = new Token(chainId, address, decimals, symbol);\n\n                const amount = Web3.utils.toWei(this.pledgeAmount.toString(), 'ether');\n                const result = await useSushiBarEnter(library, account, tokenData, amount);\n                if (result.hash) {\n                    event.$emit('sendSuccess');\n                    event.$emit('sendtx', [\n                        result,\n                        {\n                            okinfo: `存入 ${this.pledgeAmount} mLAMB ${this.$t('notice.n42')}`,\n                            failinfo: `存入 ${this.pledgeAmount} mLAMB ${this.$t('notice.n43')}`,\n                        },\n                    ]);\n                }\n            } catch (error) {\n                console.log(error);\n            } finally {\n                this.openPledgeDialog = false;\n                this.sendLoading = false;\n            }\n        },\n\n        open(data) {\n            console.log({ data });\n            this.data = {};\n            this.data = data;\n            this.pledgeAmount = '';\n            this.getMlambBalance();\n            this.openPledgeDialog = true;\n        },\n\n        // 获取mlamb余额\n        async getMlambBalance() {\n            const [mLAMBItem] = token.tokens.filter(item => item.name === 'mLAMB' && item.chainId === this.ethChainID);\n            const contractAddress = mLAMBItem.address;\n            const abi = mLAMBAbi;\n            const contract = new this.web3.eth.Contract(abi, contractAddress);\n            try {\n                const res = await contract.methods\n                    .balanceOf(this.ethAddress)\n                    .call();\n                let result = new BigNumber(res).div(\"1e18\").decimalPlaces(6).toNumber();\n                if (isNaN(result)) {\n                    result = 0;\n                }\n                this.mLAMBBalance = result;\n            } catch (error) {\n                console.log(error);\n            }\n        },\n\n        // 检查授权\n        checkApprove: debounce(async function() {\n            try {\n                const chainId = this.ethChainID;\n                const address = this.data && this.data.data.rewardTokenAddress;\n                const decimals = this.data && this.data.decimals;\n                const symbol = this.data && this.data.symbol;\n                const tokenData = new Token(chainId, address, decimals, symbol);\n\n                // 需要将数据转为字符串格式\n                const amount = this.pledgeAmount.toString();\n\n                // 批准mlamb的授权\n                const amountToApprove = new TokenAmount(tokenData, Web3.utils.toWei(amount, 'ether'));\n\n                // xmlamb地址\n                this.tokenObj.dataAddress = this.data && this.data.address;\n                this.tokenObj.amountToApprove = amountToApprove;\n\n                // 检查授权\n                this.needApprove = await useNeedApproveInput(\n                    this.ethAddress,\n                    this.ethersprovider,\n                    amountToApprove,\n                    this.tokenObj.dataAddress\n                );\n                console.log(this.needApprove);\n            } catch (error) {\n                console.log(error);\n            }\n        }, 800),\n\n        // 授权操作\n        async approveTx() {\n            if (!this.checkData()) {\n                return false;\n            }\n            try {\n                this.approveLoading = true;\n                const result = await useApproveCallback(\n                    this.ethAddress,\n                    this.ethersprovider,\n                    this.tokenObj.amountToApprove,\n                    this.tokenObj.dataAddress\n                );\n                if (result) {\n                    const wait = await result.response.wait([1]);\n                    if (wait) {\n                        this.needApprove = false;\n                        this.approveLoading = false;\n                    }\n                }\n            } catch (error) {\n                this.approveLoading = false;\n                console.log(error);\n            }\n        },\n\n        percentage(val) {\n            const balance = new BigNumber(this.mLAMBBalance);\n            const percent = new BigNumber(val);\n            this.pledgeAmount = balance.multipliedBy(percent).decimalPlaces(6).toNumber();\n        },\n\n\n        // 限制Input输入小数点的长度\n        handleInput(e) {\n            const stringValue = e.target.value.toString();\n            this.pledgeAmount = stringValue.replace(/\\D*(\\d*)(\\.?)(\\d{0,6})\\d*/, '$1$2$3');\n        },\n\n        // 检验数据是否合法\n        checkData() {\n            const balance = this.mLAMBBalance;\n            const bigBalance = new BigNumber(balance);\n            const amount = new BigNumber(this.pledgeAmount);\n            if (this.pledgeAmount === '') {\n                this.$Notice.warning({\n                    title: this.$t('notice.n'),\n                    desc: this.$t('notice.n30'),\n                });\n                return false;\n            }\n            if (parseFloat(this.pledgeAmount) <= 0) {\n                this.$Notice.warning({\n                    title: this.$t('notice.n'),\n                    desc: this.$t('notice.n31'),\n                });\n                return false;\n            }\n            // console.log(amount.toNumber(),bigBalance.toNumber(),amount.isGreaterThan(bigBalance));\n            if (amount.isGreaterThan(bigBalance)) {\n                this.$Notice.warning({\n                    title: this.$t('notice.n'),\n                    desc: this.$t('notice.n29'),\n                });\n                return false;\n            }\n\n            return true;\n        },\n\n    },\n    watch: {\n        pledgeAmount() {\n            this.checkApprove();\n        }\n    }\n};","import mod from \"-!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../../node_modules/babel-loader/lib/index.js!../../../../../../node_modules/eslint-loader/index.js??ref--13-0!./index.js?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../../node_modules/babel-loader/lib/index.js!../../../../../../node_modules/eslint-loader/index.js??ref--13-0!./index.js?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./mlambPledge.vue?vue&type=template&id=4f88a2c8&scoped=true&\"\nimport script from \"./index.js?vue&type=script&lang=js&\"\nexport * from \"./index.js?vue&type=script&lang=js&\"\nimport style0 from \"./mlambPledge.vue?vue&type=style&index=0&id=4f88a2c8&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4f88a2c8\",\n  null\n  \n)\n\nexport default component.exports","'use strict';\nvar fixRegExpWellKnownSymbolLogic = require('../internals/fix-regexp-well-known-symbol-logic');\nvar anObject = require('../internals/an-object');\nvar toLength = require('../internals/to-length');\nvar toInteger = require('../internals/to-integer');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar advanceStringIndex = require('../internals/advance-string-index');\nvar getSubstitution = require('../internals/get-substitution');\nvar regExpExec = require('../internals/regexp-exec-abstract');\n\nvar max = Math.max;\nvar min = Math.min;\n\nvar maybeToString = function (it) {\n  return it === undefined ? it : String(it);\n};\n\n// @@replace logic\nfixRegExpWellKnownSymbolLogic('replace', 2, function (REPLACE, nativeReplace, maybeCallNative, reason) {\n  var REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE = reason.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE;\n  var REPLACE_KEEPS_$0 = reason.REPLACE_KEEPS_$0;\n  var UNSAFE_SUBSTITUTE = REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE ? '$' : '$0';\n\n  return [\n    // `String.prototype.replace` method\n    // https://tc39.es/ecma262/#sec-string.prototype.replace\n    function replace(searchValue, replaceValue) {\n      var O = requireObjectCoercible(this);\n      var replacer = searchValue == undefined ? undefined : searchValue[REPLACE];\n      return replacer !== undefined\n        ? replacer.call(searchValue, O, replaceValue)\n        : nativeReplace.call(String(O), searchValue, replaceValue);\n    },\n    // `RegExp.prototype[@@replace]` method\n    // https://tc39.es/ecma262/#sec-regexp.prototype-@@replace\n    function (regexp, replaceValue) {\n      if (\n        (!REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE && REPLACE_KEEPS_$0) ||\n        (typeof replaceValue === 'string' && replaceValue.indexOf(UNSAFE_SUBSTITUTE) === -1)\n      ) {\n        var res = maybeCallNative(nativeReplace, regexp, this, replaceValue);\n        if (res.done) return res.value;\n      }\n\n      var rx = anObject(regexp);\n      var S = String(this);\n\n      var functionalReplace = typeof replaceValue === 'function';\n      if (!functionalReplace) replaceValue = String(replaceValue);\n\n      var global = rx.global;\n      if (global) {\n        var fullUnicode = rx.unicode;\n        rx.lastIndex = 0;\n      }\n      var results = [];\n      while (true) {\n        var result = regExpExec(rx, S);\n        if (result === null) break;\n\n        results.push(result);\n        if (!global) break;\n\n        var matchStr = String(result[0]);\n        if (matchStr === '') rx.lastIndex = advanceStringIndex(S, toLength(rx.lastIndex), fullUnicode);\n      }\n\n      var accumulatedResult = '';\n      var nextSourcePosition = 0;\n      for (var i = 0; i < results.length; i++) {\n        result = results[i];\n\n        var matched = String(result[0]);\n        var position = max(min(toInteger(result.index), S.length), 0);\n        var captures = [];\n        // NOTE: This is equivalent to\n        //   captures = result.slice(1).map(maybeToString)\n        // but for some reason `nativeSlice.call(result, 1, result.length)` (called in\n        // the slice polyfill when slicing native arrays) \"doesn't work\" in safari 9 and\n        // causes a crash (https://pastebin.com/N21QzeQA) when trying to debug it.\n        for (var j = 1; j < result.length; j++) captures.push(maybeToString(result[j]));\n        var namedCaptures = result.groups;\n        if (functionalReplace) {\n          var replacerArgs = [matched].concat(captures, position, S);\n          if (namedCaptures !== undefined) replacerArgs.push(namedCaptures);\n          var replacement = String(replaceValue.apply(undefined, replacerArgs));\n        } else {\n          replacement = getSubstitution(matched, S, position, captures, namedCaptures, replaceValue);\n        }\n        if (position >= nextSourcePosition) {\n          accumulatedResult += S.slice(nextSourcePosition, position) + replacement;\n          nextSourcePosition = position + matched.length;\n        }\n      }\n      return accumulatedResult + S.slice(nextSourcePosition);\n    }\n  ];\n});\n","export * from \"-!../../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./mlambPledge.vue?vue&type=style&index=0&id=4f88a2c8&lang=less&scoped=true&\""],"sourceRoot":""}